{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineComponent, getCurrentInstance, ref, computed, unref, watch, shallowRef, onMounted, onBeforeUnmount, provide, openBlock, createElementBlock, normalizeClass, withModifiers, createElementVNode, normalizeStyle, createBlock, Transition, withCtx, withDirectives, createVNode, vShow, createCommentVNode, renderSlot, Fragment, renderList, toDisplayString } from 'vue';\nimport { throttle } from 'lodash-unified';\nimport { useResizeObserver } from '@vueuse/core';\nimport '../../../utils/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport { ArrowLeft, ArrowRight } from '@element-plus/icons-vue';\nimport '../../../hooks/index.mjs';\nimport '../../../tokens/index.mjs';\nimport { carouselProps, carouselEmits } from './carousel.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useOrderedChildren } from '../../../hooks/use-ordered-children/index.mjs';\nimport { isString } from '@vue/shared';\nimport { debugWarn } from '../../../utils/error.mjs';\nimport { carouselContextKey } from '../../../tokens/carousel.mjs';\nconst _hoisted_1 = [\"onMouseenter\", \"onMouseleave\"];\nconst _hoisted_2 = [\"onMouseenter\", \"onClick\"];\nconst _hoisted_3 = {\n  key: 0\n};\nconst COMPONENT_NAME = \"ElCarousel\";\nconst THROTTLE_TIME = 300;\nconst __default__ = defineComponent({\n  name: \"ElCarousel\"\n});\nconst _sfc_main = /* @__PURE__ */defineComponent({\n  ...__default__,\n  props: carouselProps,\n  emits: carouselEmits,\n  setup(__props, {\n    expose,\n    emit\n  }) {\n    const props = __props;\n    const ns = useNamespace(\"carousel\");\n    const {\n      children: items,\n      addChild: addItem,\n      removeChild: removeItem\n    } = useOrderedChildren(getCurrentInstance(), \"ElCarouselItem\");\n    const activeIndex = ref(-1);\n    const timer = ref(null);\n    const hover = ref(false);\n    const root = ref();\n    const arrowDisplay = computed(() => props.arrow !== \"never\" && !unref(isVertical));\n    const hasLabel = computed(() => {\n      return items.value.some(item => item.props.label.toString().length > 0);\n    });\n    const carouselClasses = computed(() => {\n      const classes = [ns.b(), ns.m(props.direction)];\n      if (unref(isCardType)) {\n        classes.push(ns.m(\"card\"));\n      }\n      return classes;\n    });\n    const indicatorsClasses = computed(() => {\n      const classes = [ns.e(\"indicators\"), ns.em(\"indicators\", props.direction)];\n      if (hasLabel.value) {\n        classes.push(ns.em(\"indicators\", \"labels\"));\n      }\n      if (props.indicatorPosition === \"outside\" || unref(isCardType)) {\n        classes.push(ns.em(\"indicators\", \"outside\"));\n      }\n      return classes;\n    });\n    const isCardType = computed(() => props.type === \"card\");\n    const isVertical = computed(() => props.direction === \"vertical\");\n    const throttledArrowClick = throttle(index => {\n      setActiveItem(index);\n    }, THROTTLE_TIME, {\n      trailing: true\n    });\n    const throttledIndicatorHover = throttle(index => {\n      handleIndicatorHover(index);\n    }, THROTTLE_TIME);\n    function pauseTimer() {\n      if (timer.value) {\n        clearInterval(timer.value);\n        timer.value = null;\n      }\n    }\n    function startTimer() {\n      if (props.interval <= 0 || !props.autoplay || timer.value) return;\n      timer.value = setInterval(() => playSlides(), props.interval);\n    }\n    const playSlides = () => {\n      if (activeIndex.value < items.value.length - 1) {\n        activeIndex.value = activeIndex.value + 1;\n      } else if (props.loop) {\n        activeIndex.value = 0;\n      }\n    };\n    function setActiveItem(index) {\n      if (isString(index)) {\n        const filteredItems = items.value.filter(item => item.props.name === index);\n        if (filteredItems.length > 0) {\n          index = items.value.indexOf(filteredItems[0]);\n        }\n      }\n      index = Number(index);\n      if (Number.isNaN(index) || index !== Math.floor(index)) {\n        debugWarn(COMPONENT_NAME, \"index must be integer.\");\n        return;\n      }\n      const itemCount = items.value.length;\n      const oldIndex = activeIndex.value;\n      if (index < 0) {\n        activeIndex.value = props.loop ? itemCount - 1 : 0;\n      } else if (index >= itemCount) {\n        activeIndex.value = props.loop ? 0 : itemCount - 1;\n      } else {\n        activeIndex.value = index;\n      }\n      if (oldIndex === activeIndex.value) {\n        resetItemPosition(oldIndex);\n      }\n      resetTimer();\n    }\n    function resetItemPosition(oldIndex) {\n      items.value.forEach((item, index) => {\n        item.translateItem(index, activeIndex.value, oldIndex);\n      });\n    }\n    function itemInStage(item, index) {\n      var _a, _b, _c, _d;\n      const _items = unref(items);\n      const itemCount = _items.length;\n      if (itemCount === 0 || !item.states.inStage) return false;\n      const nextItemIndex = index + 1;\n      const prevItemIndex = index - 1;\n      const lastItemIndex = itemCount - 1;\n      const isLastItemActive = _items[lastItemIndex].states.active;\n      const isFirstItemActive = _items[0].states.active;\n      const isNextItemActive = (_b = (_a = _items[nextItemIndex]) == null ? void 0 : _a.states) == null ? void 0 : _b.active;\n      const isPrevItemActive = (_d = (_c = _items[prevItemIndex]) == null ? void 0 : _c.states) == null ? void 0 : _d.active;\n      if (index === lastItemIndex && isFirstItemActive || isNextItemActive) {\n        return \"left\";\n      } else if (index === 0 && isLastItemActive || isPrevItemActive) {\n        return \"right\";\n      }\n      return false;\n    }\n    function handleMouseEnter() {\n      hover.value = true;\n      if (props.pauseOnHover) {\n        pauseTimer();\n      }\n    }\n    function handleMouseLeave() {\n      hover.value = false;\n      startTimer();\n    }\n    function handleButtonEnter(arrow) {\n      if (unref(isVertical)) return;\n      items.value.forEach((item, index) => {\n        if (arrow === itemInStage(item, index)) {\n          item.states.hover = true;\n        }\n      });\n    }\n    function handleButtonLeave() {\n      if (unref(isVertical)) return;\n      items.value.forEach(item => {\n        item.states.hover = false;\n      });\n    }\n    function handleIndicatorClick(index) {\n      activeIndex.value = index;\n    }\n    function handleIndicatorHover(index) {\n      if (props.trigger === \"hover\" && index !== activeIndex.value) {\n        activeIndex.value = index;\n      }\n    }\n    function prev() {\n      setActiveItem(activeIndex.value - 1);\n    }\n    function next() {\n      setActiveItem(activeIndex.value + 1);\n    }\n    function resetTimer() {\n      pauseTimer();\n      startTimer();\n    }\n    watch(() => activeIndex.value, (current, prev2) => {\n      resetItemPosition(prev2);\n      if (prev2 > -1) {\n        emit(\"change\", current, prev2);\n      }\n    });\n    watch(() => props.autoplay, autoplay => {\n      autoplay ? startTimer() : pauseTimer();\n    });\n    watch(() => props.loop, () => {\n      setActiveItem(activeIndex.value);\n    });\n    watch(() => props.interval, () => {\n      resetTimer();\n    });\n    watch(() => items.value, () => {\n      if (items.value.length > 0) setActiveItem(props.initialIndex);\n    });\n    const resizeObserver = shallowRef();\n    onMounted(() => {\n      resizeObserver.value = useResizeObserver(root.value, () => {\n        resetItemPosition();\n      });\n      startTimer();\n    });\n    onBeforeUnmount(() => {\n      pauseTimer();\n      if (root.value && resizeObserver.value) resizeObserver.value.stop();\n    });\n    provide(carouselContextKey, {\n      root,\n      isCardType,\n      isVertical,\n      items,\n      loop: props.loop,\n      addItem,\n      removeItem,\n      setActiveItem\n    });\n    expose({\n      setActiveItem,\n      prev,\n      next\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        ref_key: \"root\",\n        ref: root,\n        class: normalizeClass(unref(carouselClasses)),\n        onMouseenter: withModifiers(handleMouseEnter, [\"stop\"]),\n        onMouseleave: withModifiers(handleMouseLeave, [\"stop\"])\n      }, [createElementVNode(\"div\", {\n        class: normalizeClass(unref(ns).e(\"container\")),\n        style: normalizeStyle({\n          height: _ctx.height\n        })\n      }, [unref(arrowDisplay) ? (openBlock(), createBlock(Transition, {\n        key: 0,\n        name: \"carousel-arrow-left\",\n        persisted: \"\"\n      }, {\n        default: withCtx(() => [withDirectives(createElementVNode(\"button\", {\n          type: \"button\",\n          class: normalizeClass([unref(ns).e(\"arrow\"), unref(ns).em(\"arrow\", \"left\")]),\n          onMouseenter: _cache[0] || (_cache[0] = $event => handleButtonEnter(\"left\")),\n          onMouseleave: handleButtonLeave,\n          onClick: _cache[1] || (_cache[1] = withModifiers($event => unref(throttledArrowClick)(activeIndex.value - 1), [\"stop\"]))\n        }, [createVNode(unref(ElIcon), null, {\n          default: withCtx(() => [createVNode(unref(ArrowLeft))]),\n          _: 1\n        })], 34), [[vShow, (_ctx.arrow === \"always\" || hover.value) && (props.loop || activeIndex.value > 0)]])]),\n        _: 1\n      })) : createCommentVNode(\"v-if\", true), unref(arrowDisplay) ? (openBlock(), createBlock(Transition, {\n        key: 1,\n        name: \"carousel-arrow-right\",\n        persisted: \"\"\n      }, {\n        default: withCtx(() => [withDirectives(createElementVNode(\"button\", {\n          type: \"button\",\n          class: normalizeClass([unref(ns).e(\"arrow\"), unref(ns).em(\"arrow\", \"right\")]),\n          onMouseenter: _cache[2] || (_cache[2] = $event => handleButtonEnter(\"right\")),\n          onMouseleave: handleButtonLeave,\n          onClick: _cache[3] || (_cache[3] = withModifiers($event => unref(throttledArrowClick)(activeIndex.value + 1), [\"stop\"]))\n        }, [createVNode(unref(ElIcon), null, {\n          default: withCtx(() => [createVNode(unref(ArrowRight))]),\n          _: 1\n        })], 34), [[vShow, (_ctx.arrow === \"always\" || hover.value) && (props.loop || activeIndex.value < unref(items).length - 1)]])]),\n        _: 1\n      })) : createCommentVNode(\"v-if\", true), renderSlot(_ctx.$slots, \"default\")], 6), _ctx.indicatorPosition !== \"none\" ? (openBlock(), createElementBlock(\"ul\", {\n        key: 0,\n        class: normalizeClass(unref(indicatorsClasses))\n      }, [(openBlock(true), createElementBlock(Fragment, null, renderList(unref(items), (item, index) => {\n        return openBlock(), createElementBlock(\"li\", {\n          key: index,\n          class: normalizeClass([unref(ns).e(\"indicator\"), unref(ns).em(\"indicator\", _ctx.direction), unref(ns).is(\"active\", index === activeIndex.value)]),\n          onMouseenter: $event => unref(throttledIndicatorHover)(index),\n          onClick: withModifiers($event => handleIndicatorClick(index), [\"stop\"])\n        }, [createElementVNode(\"button\", {\n          class: normalizeClass(unref(ns).e(\"button\"))\n        }, [unref(hasLabel) ? (openBlock(), createElementBlock(\"span\", _hoisted_3, toDisplayString(item.props.label), 1)) : createCommentVNode(\"v-if\", true)], 2)], 42, _hoisted_2);\n      }), 128))], 2)) : createCommentVNode(\"v-if\", true)], 42, _hoisted_1);\n    };\n  }\n});\nvar Carousel = /* @__PURE__ */_export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/carousel/src/carousel.vue\"]]);\nexport { Carousel as default };","map":{"version":3,"mappings":"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","names":["name","useNamespace","children","addChild","removeChild","getCurrentInstance","ref","root","computed","props","arrow","unref","value","item","label","ns","isCardType","classes","push","m","e","em","hasLabel","type","isVertical","direction","throttle","index","setActiveItem","trailing","handleIndicatorHover","THROTTLE_TIME","timer","clearInterval","interval","autoplay","setInterval","playSlides","activeIndex","items","length","loop","indexOf","Number","isNaN","Math","debugWarn","COMPONENT_NAME","oldIndex","itemCount","resetItemPosition","resetTimer","translateItem","_items","nextItemIndex","prevItemIndex","_b","handleMouseEnter","hover","pauseTimer","handleMouseLeave","startTimer","itemInStage","watch","emit","onMounted","resizeObserver","onBeforeUnmount","provide","addItem","removeItem","expose","prev","next"],"sources":["../../../../../../packages/components/carousel/src/carousel.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"root\"\n    :class=\"carouselClasses\"\n    @mouseenter.stop=\"handleMouseEnter\"\n    @mouseleave.stop=\"handleMouseLeave\"\n  >\n    <div :class=\"ns.e('container')\" :style=\"{ height: height }\">\n      <transition v-if=\"arrowDisplay\" name=\"carousel-arrow-left\">\n        <button\n          v-show=\"\n            (arrow === 'always' || hover) && (props.loop || activeIndex > 0)\n          \"\n          type=\"button\"\n          :class=\"[ns.e('arrow'), ns.em('arrow', 'left')]\"\n          @mouseenter=\"handleButtonEnter('left')\"\n          @mouseleave=\"handleButtonLeave\"\n          @click.stop=\"throttledArrowClick(activeIndex - 1)\"\n        >\n          <ElIcon>\n            <ArrowLeft />\n          </ElIcon>\n        </button>\n      </transition>\n      <transition v-if=\"arrowDisplay\" name=\"carousel-arrow-right\">\n        <button\n          v-show=\"\n            (arrow === 'always' || hover) &&\n            (props.loop || activeIndex < items.length - 1)\n          \"\n          type=\"button\"\n          :class=\"[ns.e('arrow'), ns.em('arrow', 'right')]\"\n          @mouseenter=\"handleButtonEnter('right')\"\n          @mouseleave=\"handleButtonLeave\"\n          @click.stop=\"throttledArrowClick(activeIndex + 1)\"\n        >\n          <ElIcon>\n            <ArrowRight />\n          </ElIcon>\n        </button>\n      </transition>\n      <slot />\n    </div>\n    <ul v-if=\"indicatorPosition !== 'none'\" :class=\"indicatorsClasses\">\n      <li\n        v-for=\"(item, index) in items\"\n        :key=\"index\"\n        :class=\"[\n          ns.e('indicator'),\n          ns.em('indicator', direction),\n          ns.is('active', index === activeIndex),\n        ]\"\n        @mouseenter=\"throttledIndicatorHover(index)\"\n        @click.stop=\"handleIndicatorClick(index)\"\n      >\n        <button :class=\"ns.e('button')\">\n          <span v-if=\"hasLabel\">{{ item.props.label }}</span>\n        </button>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport {\n  computed,\n  getCurrentInstance,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  ref,\n  shallowRef,\n  unref,\n  watch,\n} from 'vue'\nimport { throttle } from 'lodash-unified'\nimport { useResizeObserver } from '@vueuse/core'\nimport { debugWarn, isString } from '@element-plus/utils'\nimport { ElIcon } from '@element-plus/components/icon'\nimport { ArrowLeft, ArrowRight } from '@element-plus/icons-vue'\nimport { useNamespace, useOrderedChildren } from '@element-plus/hooks'\nimport { carouselContextKey } from '@element-plus/tokens'\nimport { carouselEmits, carouselProps } from './carousel'\nimport type { CarouselItemContext } from '@element-plus/tokens'\n\ndefineOptions({\n  name: 'ElCarousel',\n})\n\nconst props = defineProps(carouselProps)\nconst emit = defineEmits(carouselEmits)\nconst ns = useNamespace('carousel')\nconst COMPONENT_NAME = 'ElCarousel'\nconst THROTTLE_TIME = 300\n\nconst {\n  children: items,\n  addChild: addItem,\n  removeChild: removeItem,\n} = useOrderedChildren<CarouselItemContext>(\n  getCurrentInstance()!,\n  'ElCarouselItem'\n)\n\n// refs\nconst activeIndex = ref(-1)\nconst timer = ref<ReturnType<typeof setInterval> | null>(null)\nconst hover = ref(false)\nconst root = ref<HTMLDivElement>()\n\n// computed\nconst arrowDisplay = computed(\n  () => props.arrow !== 'never' && !unref(isVertical)\n)\n\nconst hasLabel = computed(() => {\n  return items.value.some((item) => item.props.label.toString().length > 0)\n})\n\nconst carouselClasses = computed(() => {\n  const classes = [ns.b(), ns.m(props.direction)]\n  if (unref(isCardType)) {\n    classes.push(ns.m('card'))\n  }\n  return classes\n})\n\nconst indicatorsClasses = computed(() => {\n  const classes = [ns.e('indicators'), ns.em('indicators', props.direction)]\n  if (hasLabel.value) {\n    classes.push(ns.em('indicators', 'labels'))\n  }\n  if (props.indicatorPosition === 'outside' || unref(isCardType)) {\n    classes.push(ns.em('indicators', 'outside'))\n  }\n  return classes\n})\n\nconst isCardType = computed(() => props.type === 'card')\nconst isVertical = computed(() => props.direction === 'vertical')\n\n// methods\nconst throttledArrowClick = throttle(\n  (index: number) => {\n    setActiveItem(index)\n  },\n  THROTTLE_TIME,\n  { trailing: true }\n)\n\nconst throttledIndicatorHover = throttle((index: number) => {\n  handleIndicatorHover(index)\n}, THROTTLE_TIME)\n\nfunction pauseTimer() {\n  if (timer.value) {\n    clearInterval(timer.value)\n    timer.value = null\n  }\n}\n\nfunction startTimer() {\n  if (props.interval <= 0 || !props.autoplay || timer.value) return\n  timer.value = setInterval(() => playSlides(), props.interval)\n}\n\nconst playSlides = () => {\n  if (activeIndex.value < items.value.length - 1) {\n    activeIndex.value = activeIndex.value + 1\n  } else if (props.loop) {\n    activeIndex.value = 0\n  }\n}\n\nfunction setActiveItem(index: number | string) {\n  if (isString(index)) {\n    const filteredItems = items.value.filter(\n      (item) => item.props.name === index\n    )\n    if (filteredItems.length > 0) {\n      index = items.value.indexOf(filteredItems[0])\n    }\n  }\n  index = Number(index)\n  if (Number.isNaN(index) || index !== Math.floor(index)) {\n    debugWarn(COMPONENT_NAME, 'index must be integer.')\n    return\n  }\n  const itemCount = items.value.length\n  const oldIndex = activeIndex.value\n  if (index < 0) {\n    activeIndex.value = props.loop ? itemCount - 1 : 0\n  } else if (index >= itemCount) {\n    activeIndex.value = props.loop ? 0 : itemCount - 1\n  } else {\n    activeIndex.value = index\n  }\n  if (oldIndex === activeIndex.value) {\n    resetItemPosition(oldIndex)\n  }\n  resetTimer()\n}\n\nfunction resetItemPosition(oldIndex?: number) {\n  items.value.forEach((item, index) => {\n    item.translateItem(index, activeIndex.value, oldIndex)\n  })\n}\n\nfunction itemInStage(item: CarouselItemContext, index: number) {\n  const _items = unref(items)\n  const itemCount = _items.length\n  if (itemCount === 0 || !item.states.inStage) return false\n  const nextItemIndex = index + 1\n  const prevItemIndex = index - 1\n  const lastItemIndex = itemCount - 1\n  const isLastItemActive = _items[lastItemIndex].states.active\n  const isFirstItemActive = _items[0].states.active\n  const isNextItemActive = _items[nextItemIndex]?.states?.active\n  const isPrevItemActive = _items[prevItemIndex]?.states?.active\n\n  if ((index === lastItemIndex && isFirstItemActive) || isNextItemActive) {\n    return 'left'\n  } else if ((index === 0 && isLastItemActive) || isPrevItemActive) {\n    return 'right'\n  }\n  return false\n}\n\nfunction handleMouseEnter() {\n  hover.value = true\n  if (props.pauseOnHover) {\n    pauseTimer()\n  }\n}\n\nfunction handleMouseLeave() {\n  hover.value = false\n  startTimer()\n}\n\nfunction handleButtonEnter(arrow: 'left' | 'right') {\n  if (unref(isVertical)) return\n  items.value.forEach((item, index) => {\n    if (arrow === itemInStage(item, index)) {\n      item.states.hover = true\n    }\n  })\n}\n\nfunction handleButtonLeave() {\n  if (unref(isVertical)) return\n  items.value.forEach((item) => {\n    item.states.hover = false\n  })\n}\n\nfunction handleIndicatorClick(index: number) {\n  activeIndex.value = index\n}\n\nfunction handleIndicatorHover(index: number) {\n  if (props.trigger === 'hover' && index !== activeIndex.value) {\n    activeIndex.value = index\n  }\n}\n\nfunction prev() {\n  setActiveItem(activeIndex.value - 1)\n}\n\nfunction next() {\n  setActiveItem(activeIndex.value + 1)\n}\n\nfunction resetTimer() {\n  pauseTimer()\n  startTimer()\n}\n\n// watch\nwatch(\n  () => activeIndex.value,\n  (current, prev) => {\n    resetItemPosition(prev)\n    if (prev > -1) {\n      emit('change', current, prev)\n    }\n  }\n)\nwatch(\n  () => props.autoplay,\n  (autoplay) => {\n    autoplay ? startTimer() : pauseTimer()\n  }\n)\nwatch(\n  () => props.loop,\n  () => {\n    setActiveItem(activeIndex.value)\n  }\n)\n\nwatch(\n  () => props.interval,\n  () => {\n    resetTimer()\n  }\n)\n\nwatch(\n  () => items.value,\n  () => {\n    if (items.value.length > 0) setActiveItem(props.initialIndex)\n  }\n)\n\nconst resizeObserver = shallowRef<ReturnType<typeof useResizeObserver>>()\n// lifecycle\nonMounted(() => {\n  resizeObserver.value = useResizeObserver(root.value, () => {\n    resetItemPosition()\n  })\n  startTimer()\n})\n\nonBeforeUnmount(() => {\n  pauseTimer()\n  if (root.value && resizeObserver.value) resizeObserver.value.stop()\n})\n\n// provide\nprovide(carouselContextKey, {\n  root,\n  isCardType,\n  isVertical,\n  items,\n  loop: props.loop,\n  addItem,\n  removeItem,\n  setActiveItem,\n})\n\ndefineExpose({\n  /** @description manually switch slide */\n  setActiveItem,\n  /** @description switch to the previous slide */\n  prev,\n  /** @description switch to the next slide */\n  next,\n})\n</script>\n"]},"metadata":{},"sourceType":"module"}